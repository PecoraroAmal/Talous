<!DOCTYPE html>
<html lang="it-IT" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Talous™ - Settings</title>
  <link rel="icon" type="image/png" href="/Talous/icons/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/Talous/icons/favicon.svg" />
  <link rel="shortcut icon" href="/Talous/icons/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/Talous/icons/apple-touch-icon.png" />
  <link rel="manifest" href="/Talous/manifest.json?v=5.3" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" crossorigin="anonymous">
  <link rel="stylesheet" href="/Talous/style.css?v=5.3">
  <link rel="stylesheet" href="/Talous/settings/settings.css?v=5.3">
  <script>
      if (window.location.pathname + window.location.search !== '/Talous/settings/settings.html?v=5.3') {
          window.location.replace('/Talous/settings/settings.html?v=5.3');
      }
  </script>
</head>
<body>
  <nav class="app-nav">
    <a href="/Talous/index.html?v=5.3" title="Dashboard" aria-label="Dashboard"><i class="fa-solid fa-house"></i></a>
    <a href="/Talous/transactions/transactions.html?v=5.3" title="Transactions" aria-label="Transactions"><i class="fa-solid fa-money-bill-transfer"></i></a>
    <a href="/Talous/charts/charts.html?v=5.3" title="Charts" aria-label="Charts"><i class="fa-solid fa-chart-pie"></i></a>
    <a href="/Talous/tools/tools.html?v=5.3" title="Tools" aria-label="Tools"><i class="fa-solid fa-screwdriver-wrench"></i></a>
    <a href="/Talous/settings/settings.html?v=5.3" class="active" title="Settings" aria-label="Settings"><i class="fa-solid fa-gear"></i></a>
  </nav>

  <div class="container">
    <header>
      <h1>Settings</h1>
    </header>

    <main>
      <!-- Theme Settings -->
      <section class="theme-section">
        <h2>Appearance</h2>
        <button id="toggle-theme-btn" class="theme-btn">
          <i class="fa-solid fa-sun" id="theme-icon"></i>
        </button>
        <p class="theme-description">Switch between light and dark theme</p>
      </section>

      <!-- Data Management -->
      <section class="data-management">
        <h2>Data Management</h2>
        <div class="data-section">
          <input type="file" id="upload-input" accept=".json" style="display: none;">
          <div class="action-group">
            <button id="upload-btn" class="action-btn" title="Upload JSON">
              <i class="fa-solid fa-upload"></i>
            </button>
            <span class="action-label">Upload</span>
          </div>
          <div class="action-group">
            <button id="download-btn" class="action-btn" title="Download JSON">
              <i class="fa-solid fa-download"></i>
            </button>
            <span class="action-label">Download</span>
          </div>
          <div class="action-group">
            <button id="download-sample-btn" class="action-btn" title="Sample Data">
              <i class="fa-solid fa-file-arrow-down"></i>
            </button>
            <span class="action-label">Sample</span>
          </div>
          <div class="action-group">
            <button id="clear-btn" class="action-btn delete-btn" title="Clear All Data">
              <i class="fa-solid fa-trash"></i>
            </button>
            <span class="action-label">Clear</span>
          </div>
        </div>
        <p class="section-description">Import, export, or reset your financial data. All data is stored locally on your device.</p>
      </section>

      <!-- Information Section -->
      <section class="info-section">
        <h2>Information</h2>
        <div class="info-cards">
          <div class="info-card" id="privacy-card">
            <i class="fa-solid fa-shield-halved"></i>
            <h3>Privacy</h3>
            <p>Your data stays on your device</p>
          </div>
          <div class="info-card" id="how-card">
            <i class="fa-solid fa-circle-info"></i>
            <h3>How it Works</h3>
            <p>Learn about the app features</p>
          </div>
          <div class="info-card" onclick="window.open('https://github.com/PecoraroAmal/Talous', '_blank')">
            <i class="fa-brands fa-github"></i>
            <h3>GitHub</h3>
            <p>View source code</p>
          </div>
        </div>
      </section>

      <!-- Footer Links -->
      <footer>
        <a href="https://www.paypal.com/donate/?hosted_button_id=5Z5N9EBJERXC6" target="_blank" class="support-btn">Support</a>
        <div style="margin-top:12px;">
          <button id="install-pwa-btn" class="support-btn">
            <i class="fa-solid fa-download"></i> Install App
          </button>
        </div>
        <p>Version 5.3</p>
        <br>
        <a href="https://pecoraroamal.github.io/Beskytter" target="_blank" rel="noopener">Beskytter™</a>
      </footer>
    </main>

    <!-- Privacy Modal -->
    <div id="privacy-modal" class="modal-overlay hidden">
      <div class="modal-content">
        <h2>Cookie & Privacy Policy</h2>
        <p>Talous™ stores all your data locally on your device using localStorage. No data is sent to any server.</p>
        <p>This application does not use cookies for tracking or analytics. Only essential browser storage is used to save your data locally.</p>
        <p>You can delete your data at any time using the "Clear All Data" button in Settings.</p>
        <button id="close-privacy-btn">Close</button>
      </div>
    </div>

    <!-- How it Works Modal -->
    <div id="how-modal" class="modal-overlay hidden">
      <div class="modal-content how-large">
        <div class="how-header">
          <h2>How it Works</h2>
          <span class="how-badge" aria-label="Talous means economy">Talous means economy</span>
        </div>
        <p class="lead">Talous™ is an offline-first personal finance Progressive Web App designed for speed, privacy and control. Everything stays on your device unless you export it.</p>

        <div class="how-grid">
          <section>
            <h3>Overview</h3>
            <p>Talous™ lets you record income, expenses and transfers, manage multiple account types (banks, physical wallets, online wallets, crypto and piggy banks), define payment methods and track saving goals. Rich charts help you visualise where money comes from and where it goes.</p>
          </section>
          <section>
            <h3>Core Concepts</h3>
            <ul class="bullet-list">
              <li><strong>Accounts:</strong> Containers of funds (e.g. Bank, Wallet, Crypto). Each has its own currency and colour.</li>
              <li><strong>Shared Balance:</strong> When enabled for a bank account you can spend received funds using any method linked to that account (e.g. a 500 transfer usable via card or bank transfer).</li>
              <li><strong>Payment Methods:</strong> Specific ways to move money (Card, Cash, Wallet, Crypto). Constrained by the account type for clarity.</li>
              <li><strong>Transactions:</strong> Three types: Income (adds), Expense (subtracts), Transfer (moves between accounts).</li>
              <li><strong>Categories:</strong> Classify income and expense for analytics (e.g. Salary, Dining, Transport).</li>
              <li><strong>Goals:</strong> Target amounts with progress bars (e.g. New Car fund).</li>
              <li><strong>Charts:</strong> Pie charts by category/payment type, holdings distribution and balance trend line.</li>
            </ul>
          </section>
          <section>
            <h3>What You Can Do</h3>
            <ul class="check-list">
              <li>Add / edit accounts with colour, currency and shared balance flag.</li>
              <li>Add payment methods restricted to suitable account types.</li>
              <li>Record income, expenses and transfers (including recurring sequences).</li>
              <li>Track saving goals and monitor percentage progress.</li>
              <li>Filter, search and edit existing transactions quickly.</li>
              <li>Analyse data with dynamic charts (categories, methods, holdings, trend).</li>
              <li>Toggle theme (light/dark) and install as a PWA.</li>
              <li>Export all data to JSON, import on another device, or reset locally.</li>
            </ul>
          </section>
          <section>
            <h3>Data & Privacy</h3>
            <p>All information (accounts, methods, categories, goals, transactions and settings) is stored in your browser's <code>localStorage</code>. No tracking, no analytics, no external requests beyond libraries you already loaded. You can purge everything with the Clear button or manually remove the storage entry.</p>
            <p><strong>Offline:</strong> A service worker caches the app shell so you can open and use Talous™ without a network connection.</p>
          </section>
          <section>
            <h3>Installation</h3>
            <p>On compatible browsers a prompt or menu option lets you install Talous™ as an app. After installation it behaves like a native application with offline capability and faster launch.</p>
          </section>
          <section>
            <h3>Data Formats</h3>
            <p>Numbers use EU formatting (e.g. 100.000,00). Imports accept either “1.234,56” or “1235.36” automatically. Currencies follow the ISO code you assign to accounts.</p>
          </section>
          <section>
            <h3>Tips</h3>
            <ul class="bullet-list">
              <li>Enable shared balance only when all methods truly access the same pool.</li>
              <li>Keep categories concise; broad groups make charts easier to read.</li>
              <li>Use transfers rather than income+expense pairs to move money internally.</li>
              <li>Export periodically for an external backup.</li>
            </ul>
          </section>
        </div>
        <div class="how-footer">
          <button id="close-how-btn" class="primary">Close</button>
        </div>
      </div>
    </div>

    <!-- Confirm Modal (generic) -->
    <div id="confirm-modal" class="modal-overlay hidden">
      <div class="modal-content">
        <h2 id="confirm-title">Confirm</h2>
        <p id="confirm-message"></p>
        <div class="modal-actions">
          <button id="confirm-cancel-btn">Cancel</button>
          <button id="confirm-accept-btn" class="primary">Confirm</button>
        </div>
      </div>
    </div>

    <!-- Message Modal (OK only) -->
    <div id="message-modal" class="modal-overlay hidden">
      <div class="modal-content">
        <h2 id="message-title">Message</h2>
        <p id="message-text"></p>
        <div class="modal-actions">
          <button id="message-ok-btn" class="primary">OK</button>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="/Talous/settings/settings.js?v=5.3"></script>
</body>
</html>
